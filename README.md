# üì° –û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞

## üìö –û–ø–∏—Å–∞–Ω–∏–µ

API Gateway –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–µ **Gin (Go)** –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä–æ–ª—å –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–∞ –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏: `jwt-go`, `admin` –∏ `user`. –û–Ω —Ä–µ–∞–ª–∏–∑—É–µ—Ç –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—é —Ç–æ–∫–µ–Ω–æ–≤, –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é, –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞.

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü—Ä–æ–µ–∫—Ç —Å–ª–µ–¥—É–µ—Ç –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ, –≤ –∫–æ—Ç–æ—Ä–æ–π –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Å–≤–æ—é –∑–æ–Ω—É –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏:

```
                      +------------+
                      |   Client   |
                      +------------+
                            |
                            v
                    +----------------+
                    |  API Gateway   |
                    |     :80        |
                    +----------------+
                       /     |      \
                      /      |       \
                     v       v        v
               +--------+ +--------+ +--------+
               | jwt-go | | admin  | |  user  |
               | :8000  | | :3000  | | :8080  |
               +--------+ +--------+ +--------+
```

- **API Gateway** ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –≤—Ö–æ–¥–Ω–æ–π —à–ª—é–∑, –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é.
- **jwt-go** ‚Äî —Å–µ—Ä–≤–∏—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏, —Ä–∞–±–æ—Ç–∞—é—â–∏–π —Å JWT-—Ç–æ–∫–µ–Ω–∞–º–∏.
- **admin** ‚Äî —Å–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—É—Ä—Å–∞–º–∏, —É—Ä–æ–∫–∞–º–∏, —Ç–µ—Å—Ç–∞–º–∏.
- **user** ‚Äî —Å–µ—Ä–≤–∏—Å, —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—é—Ç –¥–æ—Å—Ç—É–ø –∫ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–º—É –∫–æ–Ω—Ç–µ–Ω—Ç—É.

---

## üß∞ –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

| –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è     | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                 |
|----------------|--------------------------------------------|
| Go + Gin       | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è API Gateway                     |
| Docker         | –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤              |
| JWT            | –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| HTTP Proxy     | –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤                     |
| Middleware     | –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (auth/admin)    |
| Gorm           | –†–∞–±–æ—Ç–∞ —Å –±–¥                                |

---

## ‚öôÔ∏è –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ —Ä–µ—à–µ–Ω–∏–π

- **Go –∏ Gin** ‚Äî –≤—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –ª–∞–∫–æ–Ω–∏—á–Ω–æ—Å—Ç—å –∫–æ–¥–∞.
- **JWT** ‚Äî —É–¥–æ–±–Ω—ã–π –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã–π —Å–ø–æ—Å–æ–± –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.
- **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã** ‚Äî —É–ø—Ä–æ—â–∞–µ—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ, —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ.
- **Middleware** ‚Äî –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤.

---

## üìå –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

### üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (`jwt-go:8000`)

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç              | –û–ø–∏—Å–∞–Ω–∏–µ                       | –ó–∞—â–∏—Ç–∞          |
|-------|------------------------|--------------------------------|------------------|
| POST  | `/auth/signup`         | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è       | ‚ùå               |
| POST  | `/auth/login`          | –õ–æ–≥–∏–Ω                          | ‚ùå               |
| GET   | `/auth/validate`       | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞                | ‚úÖ (auth)        |
| PUT   | `/auth/admin/update-role/:id` | –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | ‚úÖ (auth + admin) |

---

### üõ†Ô∏è –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (`admin:3000`)

> –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã —Ç—Ä–µ–±—É—é—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.

#### –ö—É—Ä—Å—ã

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç              | –û–ø–∏—Å–∞–Ω–∏–µ                  |
|-------|------------------------|----------------------------|
| POST  | `/admin/courses`       | –°–æ–∑–¥–∞—Ç—å –∫—É—Ä—Å               |
| GET   | `/admin/courses`       | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫—É—Ä—Å–æ–≤     |
| PUT   | `/admin/courses/:id`   | –û–±–Ω–æ–≤–∏—Ç—å –∫—É—Ä—Å              |
| DELETE| `/admin/courses/:id`   | –£–¥–∞–ª–∏—Ç—å –∫—É—Ä—Å               |

#### –£—Ä–æ–∫–∏

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç              | –û–ø–∏—Å–∞–Ω–∏–µ                  |
|-------|------------------------|----------------------------|
| POST  | `/admin/lessons`       | –°–æ–∑–¥–∞—Ç—å —É—Ä–æ–∫               |
| GET   | `/admin/lessons`       | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —É—Ä–æ–∫–æ–≤     |
| PUT   | `/admin/lessons/:id`   | –û–±–Ω–æ–≤–∏—Ç—å —É—Ä–æ–∫              |
| DELETE| `/admin/lessons/:id`   | –£–¥–∞–ª–∏—Ç—å —É—Ä–æ–∫               |

#### –í–ª–æ–∂–µ–Ω–∏—è

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç                          | –û–ø–∏—Å–∞–Ω–∏–µ                  |
|-------|-----------------------------------|----------------------------|
| POST  | `/admin/lesson-attachments`       | –°–æ–∑–¥–∞—Ç—å –≤–ª–æ–∂–µ–Ω–∏–µ           |
| GET   | `/admin/lesson-attachments`       | –ü–æ–ª—É—á–∏—Ç—å –≤–ª–æ–∂–µ–Ω–∏—è          |
| PUT   | `/admin/lesson-attachments/:id`   | –û–±–Ω–æ–≤–∏—Ç—å –≤–ª–æ–∂–µ–Ω–∏–µ          |
| DELETE| `/admin/lesson-attachments/:id`   | –£–¥–∞–ª–∏—Ç—å –≤–ª–æ–∂–µ–Ω–∏–µ           |

#### –¢–µ—Å—Ç—ã

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç              | –û–ø–∏—Å–∞–Ω–∏–µ                  |
|-------|------------------------|----------------------------|
| POST  | `/admin/tests`         | –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç               |
| GET   | `/admin/tests`         | –ü–æ–ª—É—á–∏—Ç—å —Ç–µ—Å—Ç—ã             |
| PUT   | `/admin/tests/:id`     | –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç              |
| DELETE| `/admin/tests/:id`     | –£–¥–∞–ª–∏—Ç—å —Ç–µ—Å—Ç               |

#### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –∫—É—Ä—Å—ã

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç                    | –û–ø–∏—Å–∞–Ω–∏–µ                        |
|-------|------------------------------|----------------------------------|
| POST  | `/admin/user-courses`        | –°–≤—è–∑–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –∫—É—Ä—Å–æ–º   |
| GET   | `/admin/user-courses`        | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å–≤—è–∑–µ–π          |
| DELETE| `/admin/user-courses/:id`    | –£–¥–∞–ª–∏—Ç—å —Å–≤—è–∑—å                   |

---

### üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è —á–∞—Å—Ç—å (`user:8080`)

> –¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è.

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç                                       | –û–ø–∏—Å–∞–Ω–∏–µ                                   |
|-------|------------------------------------------------|---------------------------------------------|
| GET   | `/user/courses`                                | –ü–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫—É—Ä—Å—ã                   |
| GET   | `/user/courses/:course_id/lessons`             | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —É—Ä–æ–∫–æ–≤ –≤ –∫—É—Ä—Å–µ            |
| GET   | `/user/lessons/:lesson_id/details`             | –ü–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª–∏ —É—Ä–æ–∫–∞                     |
| POST  | `/user/answers`                                | –û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç—ã –Ω–∞ —Ç–µ—Å—Ç—ã                 |

---

## üß© Middleware

- `RequireAuth` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∏ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ JWT.
- `RequireAdmin` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—É—é —Ä–æ–ª—å.

---

## üöÄ –ó–∞–ø—É—Å–∫

```bash
docker-compose up --build
```

---

## üìå –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–≠—Ç–æ—Ç API Gateway —Å–ª—É–∂–∏—Ç –µ–¥–∏–Ω—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–µ–∂–¥—É —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º –∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º–∏, –ø–æ–≤—ã—à–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ —É–ø—Ä–∞–≤–ª—è–µ–º–æ—Å—Ç—å. –ï–≥–æ –ª–µ–≥–∫–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –∏ —Ä–∞—Å—à–∏—Ä—è—Ç—å –Ω–æ–≤—ã–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏ –±–ª–∞–≥–æ–¥–∞—Ä—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º.


